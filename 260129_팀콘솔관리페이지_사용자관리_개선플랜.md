# 260129 팀콘솔 관리페이지 사용자관리 개선 플랜

## 1. 개요 및 목표
현재 '팀 콘솔 > 사용자 관리' 페이지는 기본적인 목록 조회와 검색 기능만 제공하고 있습니다.
소셜 로그인(카카오, 구글 등)으로 가입한 사용자들을 보다 효율적으로 관리하고, 악성 유저 차단이나 우수 유저 식별 등 **실질적인 운영 업무**를 수행할 수 있도록 기능을 고도화합니다.

---

## 2. 주요 개선 사항

### 2-1. UI/UX 개선
*   **Master-Detail 구조 도입**: 목록에서 클릭 시 우측에 '상세 정보 사이드 패널'을 띄워 페이지 이동 없이 상세 내용 확인.
*   **ASCII 목업 (제안)**:

```
┌───────────────────────────────────────────────────────────────┬───────────────────────┐
│  [검색 필터]  역할: [전체▼]  지역: [전체▼]  상태: [전체▼]   │ [메모/작업 패널]      │
│  🔍 [이름, 이메일, 전화번호 검색...]                 [초기화] │                       │
├───────────────────────────────────────────────────────────────┤  선택된 사용자:       │
│  [✅] 이름    | 이메일           | 역할 | 지역 | 가입일     │  홍길동 (Kakao)       │
├───────────────────────────────────────────────────────────────┤                       │
│  [  ] 홍길동  | hong@kakao.com   | 교사 | 경기 | 24.01.01   │  [프로필] [활동로그]  │
│  [  ] 김철수  | kim@gmail.com    | 강사 | 서울 | 24.01.02   │                       │
│  [✅] 이영희  | lee@naver.com    | 행정 | 인천 | 24.01.03   │  📛 상태 변경         │
│  [  ] 박민수  | park@test.com    | 업체 | 경기 | 24.01.05   │  (o) 정상  ( ) 차단   │
│       ...                                                     │                       │
├───────────────────────────────────────────────────────────────┤  📝 관리자 메모       │
│ [일괄 작업 ▼]                                                 │  ┌─────────────────┐  │
│ - 선택된 2명에게 공지 메일 발송                               │  │ 블랙리스트 의심 │  │
│ - 선택된 2명 상태 변경 (정상/차단)                            │  │ (24.01.29 김관리)│ │
│                                                               │  └─────────────────┘  │
│ < 1 2 3 4 5 >                                                 │  [저장]               │
└───────────────────────────────────────────────────────────────┴───────────────────────┘
```

### 2-2. 기능적 개선 (스킬셋 적용)
1.  **상세 프로필 조회 강화** (`AdminUserDetails`)
    *   **기본 정보**: 이름, 이메일, 전화번호(있는 경우), 가입 채널(Kakao/Google).
    *   **확장 정보**: 
        *   `user_profiles` 테이블의 모든 정보 (자기소개, 자격증, 전문분야 등).
        *   **활동 통계**: 작성한 공고 수, 인력 프로필 등록 여부, 북마크 수, 최근 로그인 기록.
2.  **관리자 메모 기능** (`AdminNotes`)
    *   특정 사용자에 대해 운영진만 볼 수 있는 메모 기록 (예: "2/1 비매너 신고 접수됨").
    *   별도 테이블 `admin_user_notes` 생성 필요.
3.  **활동 로그 타임라인** (`ActivityTimeline`)
    *   사용자의 최근 활동(로그인, 글 작성, 수정 등)을 시간순으로 조회.
    *   `user_activity_logs` 테이블 활용.
4.  **상태 관리 (차단/해제)**
    *   악성 유저 '차단(banned)' 처리 기능.
    *   `auth.users`의 `banned_until` 필드 활용 또는 `user_profiles.status` 업데이트.

---

## 3. 구현 상세 플랜

### 3-1. DB 변경사항 (Supabase)
1.  **관리자 메모 테이블 생성**
    ```sql
    CREATE TABLE admin_user_notes (
      id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
      target_user_id UUID REFERENCES auth.users(id),
      author_admin_id UUID REFERENCES auth.users(id),
      content TEXT NOT NULL,
      created_at TIMESTAMPTZ DEFAULT NOW()
    );
    ```
2.  **프로필 테이블 보완**
    *   `status` 컬럼 (active, suspended, banned) 관리 강화.

### 3-2. 컴포넌트 구조
*   `AdminUserManagement.tsx`: 메인 컨테이너
    *   `UserFilterBar.tsx`: 검색 및 필터링
    *   `UserListTable.tsx`: 사용자 목록 (체크박스 포함)
    *   `UserSidePanel.tsx`: 우측 상세 정보 패널 (Slide-over 형태)
        *   `UserProfileSection.tsx`: 기본 및 상세 정보
        *   `AdminMemoSection.tsx`: 관리자 메모 CRUD
        *   `UserActivitySection.tsx`: 활동 로그 타임라인

### 3-3. 효율적인 운영을 위한 Tip
*   **빠른 필터링**: '최근 24시간 내 가입', '최근 1주일 미접속', '신고 누적' 등의 프리셋 필터 제공.
*   **일괄 처리**: 프로모션 메일 발송 대상 추출을 위한 **Excel 다운로드** 기능 추가.

---

## 4. 검증 계획 (Verification)
1.  **목록 조회**: 더미 데이터 및 실제 데이터가 혼재된 상황에서 페이지네이션 및 검색이 정상 작동하는지 확인.
2.  **상세 조회**: 리스트의 한 명을 클릭했을 때 우측 패널이 부드럽게 열리고 데이터가 로딩되는지 확인.
3.  **메모 저장**: 관리자 메모를 작성하고 저장했을 때 즉시 반영되고, 다시 열었을 때 유지되는지 확인.
4.  **반응형**: 모바일 화면에서는 사이드 패널이 전체 화면 덮는 모달 형태로 변형되는지 확인.
