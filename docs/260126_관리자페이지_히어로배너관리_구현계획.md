# 관리자 페이지 - 히어로 배너 관리 구현 계획

**작성일**: 2026-01-26
**목표**: 관리자 페이지에서 히어로 섹션 배너를 손쉽게 관리할 수 있는 UI 구현

---

## 1. 현황 분석

### 1.1 기존 구조
- **데이터베이스**: Supabase의 `hero_banners` 테이블이 이미 존재
- **타입 정의**: `src/types/hero-banner.ts`에 `HeroBanner`, `HeroBannerConfig` 타입 정의됨
- **Supabase 함수**: `src/lib/supabase/hero-banner.ts`에 CRUD 함수 구현됨
  - `getHeroBannerConfig()`
  - `getActiveHeroBanners()`
  - `createHeroBanner()`
  - `updateHeroBanner()`
  - `deleteHeroBanner()`
  - `updateHeroBannerConfig()`
- **프론트엔드**: `HeroCard.tsx`가 이미 Supabase에서 데이터를 가져오도록 구현되어 있음 (현재는 주석 처리되고 DEFAULT_BANNER 사용 중)
- **관리자 페이지**: `AdminPage.tsx`에 '배너 관리' 탭이 있지만 미구현 상태

### 1.2 문제점
- 현재는 `DEFAULT_BANNER`를 하드코딩하여 사용
- 배너를 수정하려면 코드를 직접 수정해야 함
- 관리자 페이지에서 실시간으로 배너를 관리할 수 없음

---

## 2. 구현 목표

관리자 페이지에서 다음을 관리할 수 있어야 함:

1. **배너 목록 조회**: 등록된 모든 히어로 배너 확인
2. **배너 생성**: 새로운 배너 추가
3. **배너 수정**: 기존 배너 편집
   - 제목 (title)
   - 부제목 (subtitle)
   - 배경색 (bgColor)
   - 텍스트 색상 (textColor)
   - 링크 URL (linkUrl)
   - 아이콘 (icon)
   - 표시 순서 (displayOrder)
   - 활성화 상태 (isActive)
4. **배너 삭제**: 불필요한 배너 제거
5. **전역 설정**:
   - 전체 배너 시스템 활성화/비활성화 (isActive)
   - 캐러셀 회전 속도 (rotationSpeed)

---

## 3. UI 설계

### 3.1 레이아웃 구조

```
┌─────────────────────────────────────────────────────────────────┐
│  배너 관리                                                       │
├─────────────────────────────────────────────────────────────────┤
│                                                                   │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │  전역 설정                                              │    │
│  ├─────────────────────────────────────────────────────────┤    │
│  │  배너 시스템 활성화: [✓]                               │    │
│  │  회전 속도: [5] 초                                      │    │
│  │                                          [설정 저장]     │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                   │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │  배너 목록                              [+ 새 배너 추가]│    │
│  ├─────────────────────────────────────────────────────────┤    │
│  │                                                           │    │
│  │  ┌─────────────────────────────────────────────────┐    │    │
│  │  │  배너 #1                            [활성] [편집]│    │    │
│  │  ├─────────────────────────────────────────────────┤    │    │
│  │  │  제목: 설문참여해서 커피쿠폰 받기 →             │    │    │
│  │  │  배경색: ■ #3B82F6                              │    │    │
│  │  │  링크: https://forms.gle/...                    │    │    │
│  │  │  순서: 1                                         │    │    │
│  │  │                                                   │    │    │
│  │  │  미리보기:                                       │    │    │
│  │  │  ┌───────────────────────────────────┐          │    │    │
│  │  │  │ 설문참여해서 커피쿠폰 받기 →      │          │    │    │
│  │  │  └───────────────────────────────────┘          │    │    │
│  │  └─────────────────────────────────────────────────┘    │    │
│  │                                                           │    │
│  │  ┌─────────────────────────────────────────────────┐    │    │
│  │  │  배너 #2                        [비활성] [편집] │    │    │
│  │  ├─────────────────────────────────────────────────┤    │    │
│  │  │  제목: 학교와 선생님을 찾는 가장 쉬운 방법      │    │    │
│  │  │  부제목: 학교일자리.COM                         │    │    │
│  │  │  배경색: ■ #3B82F6                              │    │    │
│  │  │  순서: 2                                         │    │    │
│  │  └─────────────────────────────────────────────────┘    │    │
│  │                                                           │    │
│  └─────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────┘
```

### 3.2 배너 편집 모달

```
┌─────────────────────────────────────────────────┐
│  배너 편집                              [X]     │
├─────────────────────────────────────────────────┤
│                                                  │
│  제목 *                                          │
│  ┌──────────────────────────────────────────┐  │
│  │ 설문참여해서 커피쿠폰 받기 →             │  │
│  └──────────────────────────────────────────┘  │
│                                                  │
│  부제목 (선택)                                   │
│  ┌──────────────────────────────────────────┐  │
│  │                                           │  │
│  └──────────────────────────────────────────┘  │
│                                                  │
│  배경색 *                                        │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐     │
│  │ ■ 파랑   │  │ ■ 레드   │  │ ■ 커스텀 │     │
│  │ #3B82F6  │  │ #F87171  │  │ #______  │     │
│  └──────────┘  └──────────┘  └──────────┘     │
│                                                  │
│  텍스트 색상 *                                   │
│  ┌──────────┐  ┌──────────┐                    │
│  │ ■ 흰색   │  │ ■ 검정   │                    │
│  │ #FFFFFF  │  │ #000000  │                    │
│  └──────────┘  └──────────┘                    │
│                                                  │
│  링크 URL (선택)                                 │
│  ┌──────────────────────────────────────────┐  │
│  │ https://forms.gle/...                    │  │
│  └──────────────────────────────────────────┘  │
│                                                  │
│  아이콘 (선택)                                   │
│  ┌──────┐  ┌──────┐  ┌──────┐  ┌──────┐       │
│  │ 없음  │  │ 🔍    │  │ 🏫    │  │ 📢    │       │
│  └──────┘  └──────┘  └──────┘  └──────┘       │
│                                                  │
│  표시 순서 *                                     │
│  ┌──────────────────────────────────────────┐  │
│  │ 1                                         │  │
│  └──────────────────────────────────────────┘  │
│                                                  │
│  [ ] 활성화                                      │
│                                                  │
│  ─────────────────────────────────────────────  │
│                                                  │
│  미리보기:                                       │
│  ┌───────────────────────────────────────┐     │
│  │ 설문참여해서 커피쿠폰 받기 →          │     │
│  └───────────────────────────────────────┘     │
│                                                  │
│              [취소]           [저장]             │
└─────────────────────────────────────────────────┘
```

### 3.3 컬러 팔레트

관리자가 쉽게 선택할 수 있도록 프리셋 제공:

| 이름 | HEX | 용도 |
|------|-----|------|
| 파랑 | #3B82F6 | 기본 배너 |
| 소프트 레드 | #F87171 | 강조 배너 |
| 보라 | #5B6EF7 | (기존에 잘못 사용된 색상) |
| 녹색 | #10B981 | 긍정 메시지 |
| 노랑 | #FBBF24 | 이벤트 |
| 흰색 | #FFFFFF | 텍스트 (어두운 배경) |
| 검정 | #1F2937 | 텍스트 (밝은 배경) |

---

## 4. 컴포넌트 구조

### 4.1 파일 구조

```
src/
├── components/
│   └── admin/
│       ├── BannerManagement.tsx        # 메인 배너 관리 컴포넌트
│       ├── BannerList.tsx              # 배너 목록
│       ├── BannerCard.tsx              # 개별 배너 카드
│       ├── BannerEditModal.tsx         # 배너 편집 모달
│       ├── BannerPreview.tsx           # 배너 미리보기
│       └── GlobalBannerConfig.tsx      # 전역 설정
└── pages/
    └── AdminPage.tsx                   # 'banner' 케이스에 BannerManagement 연결
```

### 4.2 상태 관리

```typescript
// BannerManagement.tsx
const [banners, setBanners] = useState<HeroBanner[]>([])
const [config, setConfig] = useState<HeroBannerConfig | null>(null)
const [isEditModalOpen, setIsEditModalOpen] = useState(false)
const [editingBanner, setEditingBanner] = useState<HeroBanner | null>(null)
const [isLoading, setIsLoading] = useState(true)
```

---

## 5. 주요 기능 흐름

### 5.1 배너 생성
```
1. [+ 새 배너 추가] 클릭
2. BannerEditModal 열림 (빈 폼)
3. 사용자가 제목, 색상, 링크 등 입력
4. 실시간 미리보기 표시
5. [저장] 클릭
6. createHeroBanner() 호출
7. DB에 저장
8. 배너 목록 새로고침
9. 모달 닫기
```

### 5.2 배너 수정
```
1. 배너 카드에서 [편집] 클릭
2. BannerEditModal 열림 (기존 데이터 로드)
3. 사용자가 필드 수정
4. 실시간 미리보기 업데이트
5. [저장] 클릭
6. updateHeroBanner() 호출
7. DB 업데이트
8. 배너 목록 새로고침
9. 모달 닫기
```

### 5.3 배너 활성화/비활성화
```
1. 배너 카드에서 토글 버튼 클릭
2. updateHeroBanner({ isActive: !banner.isActive }) 호출
3. DB 업데이트
4. 배너 목록 새로고침
```

### 5.4 배너 삭제
```
1. 배너 카드에서 [삭제] 클릭
2. 확인 모달 표시: "정말 삭제하시겠습니까?"
3. [확인] 클릭
4. deleteHeroBanner(bannerId) 호출
5. DB에서 삭제
6. 배너 목록 새로고침
```

---

## 6. 데이터베이스 스키마 (참고)

### 6.1 hero_banners 테이블

```sql
CREATE TABLE hero_banners (
  id TEXT PRIMARY KEY,
  title TEXT NOT NULL,
  subtitle TEXT,
  bg_color TEXT NOT NULL,
  text_color TEXT NOT NULL,
  link_url TEXT,
  icon TEXT,
  display_order INTEGER NOT NULL DEFAULT 0,
  is_active BOOLEAN NOT NULL DEFAULT true,
  created_at TIMESTAMPTZ NOT NULL DEFAULT now(),
  updated_at TIMESTAMPTZ NOT NULL DEFAULT now()
);
```

### 6.2 hero_banner_config 테이블

```sql
CREATE TABLE hero_banner_config (
  id TEXT PRIMARY KEY,
  rotation_speed INTEGER NOT NULL DEFAULT 5,
  is_active BOOLEAN NOT NULL DEFAULT true,
  created_at TIMESTAMPTZ NOT NULL DEFAULT now(),
  updated_at TIMESTAMPTZ NOT NULL DEFAULT now()
);
```

---

## 7. 구현 우선순위

### Phase 1: 기본 CRUD (2시간)
- [ ] `BannerManagement.tsx` 생성
- [ ] `BannerList.tsx` 생성 (목록 표시)
- [ ] `BannerCard.tsx` 생성 (개별 카드)
- [ ] 배너 목록 조회 기능
- [ ] 배너 활성화/비활성화 토글

### Phase 2: 편집 기능 (3시간)
- [ ] `BannerEditModal.tsx` 생성
- [ ] 폼 입력 필드 구현
- [ ] 배너 생성 기능
- [ ] 배너 수정 기능
- [ ] 배너 삭제 기능

### Phase 3: 고급 기능 (2시간)
- [ ] `BannerPreview.tsx` 생성 (실시간 미리보기)
- [ ] 컬러 피커 (프리셋 + 커스텀)
- [ ] 아이콘 선택기
- [ ] 드래그 앤 드롭 순서 변경

### Phase 4: 전역 설정 (1시간)
- [ ] `GlobalBannerConfig.tsx` 생성
- [ ] 전역 활성화/비활성화
- [ ] 회전 속도 설정

### Phase 5: 통합 및 테스트 (1시간)
- [ ] AdminPage.tsx에 통합
- [ ] HeroCard.tsx에서 DEFAULT_BANNER 주석 해제하고 DB 연동 활성화
- [ ] 엣지 케이스 테스트
- [ ] UI/UX 개선

**총 예상 시간**: 9시간

---

## 8. HeroCard.tsx 수정 사항

배너 관리 UI가 완성되면, HeroCard.tsx를 다시 DB 연동으로 전환:

```typescript
// 현재 (하드코딩)
useEffect(() => {
    setBanners([DEFAULT_BANNER]);
    setConfig({ ... });
    setIsLoading(false);
}, []);

// 변경 후 (DB 연동)
useEffect(() => {
    const loadBanners = async () => {
        try {
            const [configData, bannersData] = await Promise.all([
                getHeroBannerConfig(),
                getActiveHeroBanners()
            ]);

            setConfig(configData);
            if (bannersData.length > 0) {
                setBanners(bannersData);
            } else {
                // DB에 데이터가 없으면 기본값 사용
                setBanners([DEFAULT_BANNER]);
            }
        } catch (error) {
            console.error('Failed to load hero banners:', error);
            setBanners([DEFAULT_BANNER]);
        } finally {
            setIsLoading(false);
        }
    };

    loadBanners();
}, []);
```

---

## 9. 주의사항

1. **권한 체크**: 관리자만 접근 가능하도록 `isAdmin` 체크 필수
2. **입력 검증**:
   - 제목은 필수
   - 색상 코드 유효성 검증 (HEX 형식)
   - URL 유효성 검증
3. **에러 처리**:
   - DB 연결 실패 시 사용자에게 알림
   - 저장 실패 시 재시도 가능하도록
4. **UX**:
   - 저장 중 로딩 표시
   - 성공/실패 토스트 메시지
   - 변경사항 미저장 시 확인 모달

---

## 10. 테스트 시나리오

### 10.1 배너 생성
1. 관리자 페이지 → 배너 관리 탭 이동
2. [+ 새 배너 추가] 클릭
3. 제목: "신규 이벤트", 배경색: #10B981, 링크: https://example.com
4. [저장] 클릭
5. 목록에 새 배너 표시 확인
6. 실제 사이트에서 배너 표시 확인

### 10.2 배너 수정
1. 기존 배너의 [편집] 클릭
2. 제목 수정: "설문참여해서 커피쿠폰 받기 →" → "설문 완료하고 커피 받기"
3. [저장] 클릭
4. 실제 사이트에서 변경사항 반영 확인

### 10.3 배너 비활성화
1. 배너 카드의 활성화 토글 클릭
2. DB 업데이트 확인
3. 실제 사이트에서 해당 배너 표시 안 됨 확인

---

**작성자**: Claude
**최종 수정**: 2026-01-26
