# 분리 개방 플랜 (Early Access)

## 배경 및 목적

### 현재 고민
1. **사이트 정식 오픈 전** 교원연수 강사 인력풀을 미리 확보하고 싶음
2. **main 미커밋 시**: 강사들이 등록할 통로가 없음
3. **main 커밋 시**: 일반 대중에게 강사 0명 상태로 공개됨 (신뢰도 저하)

### 해결 방향
- **비밀 URL 경로** 방식으로 특정 인원에게만 등록 기능 오픈
- 일반 사용자에게는 "준비 중" 모달 표시 (기존 컴포넌트 활용)
- main 브랜치에 커밋해도 안전하게 베타 테스터/강사 모집 가능

---

## 구현 방안: URL 경로 방식 (Path-based)

### 접속 URL 구조

```
일반 접속: https://학교일자리.com
특별 접속: https://학교일자리.com/earlyteacher2026
```

### 지원 도메인 (3개)

| 도메인 | 일반 접속 | Early Access 접속 |
|--------|----------|-------------------|
| 학교일자리.com | `https://학교일자리.com` | `https://학교일자리.com/earlyteacher2026` |
| xn--9d0bk8ucxkkcw59f.com | `https://xn--9d0bk8ucxkkcw59f.com` | `https://xn--9d0bk8ucxkkcw59f.com/earlyteacher2026` |
| localhost:5173 | `http://localhost:5173` | `http://localhost:5173/earlyteacher2026` |

### 동작 방식

```tsx
// App.tsx 또는 라우터 설정
import { BrowserRouter, Routes, Route } from 'react-router-dom';

// 경로 기반 Early Access 감지
const EarlyAccessWrapper = ({ children }) => {
  const location = useLocation();
  const isEarlyAccess = location.pathname === '/earlyteacher2026';

  // 로컬스토리지에 저장 (세션 유지)
  useEffect(() => {
    if (isEarlyAccess) {
      localStorage.setItem('earlyAccess', 'true');
    }
  }, [isEarlyAccess]);

  // 실제 Early Access 상태 (URL 또는 저장된 값)
  const hasEarlyAccess = isEarlyAccess || localStorage.getItem('earlyAccess') === 'true';

  return children({ hasEarlyAccess });
};
```

**장점**
- URL이 깔끔하고 기억하기 쉬움 (`/earlyteacher2026`)
- 쿼리 파라미터보다 공유/배포가 직관적
- 라우터 경로로 명확한 분기

---

## 기존 컴포넌트 활용

### ComingSoonModal (기존)

**경로**: `src/components/common/ComingSoonModal.tsx`

기존 즐겨찾기, 채팅 버튼 클릭 시 표시되는 "준비 중" 모달이 이미 구현되어 있음.

```tsx
interface ComingSoonModalProps {
  isOpen: boolean;
  onClose: () => void;
  title: string;  // "구직등록", "공고등록", "교원연수 강사등록" 등
}
```

**현재 디자인 요소**:
- Framer Motion 애니메이션 (fade-in, scale)
- 파란색 Sparkles 아이콘
- "해당 기능은 2월 초 업데이트 예정입니다" 메시지
- 파란색 확인 버튼 (`bg-blue-500`)

---

## 디자인 준수 사항 (Anti-Vibe Design)

**참조**: `.claude/skills/anti-vibe-design/SKILL.md`

### 절대 규칙 체크리스트

```
[x] 이모지 사용 안 함 - 모달에 이모지 포함 금지
[x] 글자 뒤 배경색 사용 안 함 - 형광펜 스타일 금지
[x] 프로젝트 컬러 팔레트 사용 - blue-500, gray 계열 사용
[x] 바이브코딩 냄새 나는 스타일 금지 - 과한 그라디언트 금지
[x] 기존 컴포넌트 패턴과 일관성 유지
```

### 적용된 디자인 토큰

| 요소 | 클래스 | 준수 여부 |
|------|--------|----------|
| 배경 오버레이 | `bg-black/40 backdrop-blur-sm` | O |
| 모달 배경 | `bg-white rounded-2xl shadow-xl` | O |
| 제목 텍스트 | `text-xl font-bold text-gray-900` | O |
| 설명 텍스트 | `text-gray-500 font-medium` | O |
| 확인 버튼 | `bg-blue-500 text-white rounded-xl` | O |
| 아이콘 | Lucide Sparkles (blue-500) | O |

---

## UI 변경 사항

### 1. 등록 버튼 클릭 시 분기

| 조건 | 공고등록 | 구직등록 | 강사등록 |
|------|---------|---------|---------|
| `/earlyteacher2026` 경로 또는 localStorage 저장됨 | 실제 등록 | 실제 등록 | 실제 등록 |
| 일반 접속 | **실제 등록** (기존대로) | ComingSoonModal | ComingSoonModal |

### 2. 영향 받는 컴포넌트

```
src/
├── App.tsx
│   └── 라우터 설정 추가 (/earlyteacher2026 경로)
├── pages/new-landing/components/Hero.tsx
│   └── onRegisterClick, onJobPostClick, onInstructorRegisterClick 핸들러
├── components/map/LayerToggleBar.tsx
│   └── 등록 버튼들
└── components/common/ComingSoonModal.tsx (기존 - 수정 불필요)
```

---

## 오류/리스크 분석

### 분기 로직으로 인한 잠재적 문제

| 리스크 | 설명 | 대응 방안 |
|--------|------|----------|
| **라우터 충돌** | `/earlyteacher2026` 경로가 기존 라우터와 충돌 가능 | SPA 구조에서 catch-all 라우트 전에 배치 |
| **로컬스토리지 만료** | 영구 저장되어 정식 오픈 후에도 유지됨 | 정식 오픈 시 Early Access 관련 코드 전체 제거 |
| **도메인별 동작 차이** | 한글 도메인(학교일자리.com)과 punycode 도메인 경로 처리 | 세 도메인 모두 동일 빌드로 배포되므로 차이 없음 |

> **참고**: Cloudflare Pages SPA 모드가 기본 지원되므로 별도 리디렉션 설정 불필요

---

## 구현 순서

### Phase 1: Early Access 상태 관리
1. `useEarlyAccess` 훅 생성 (경로 감지 + localStorage)
2. App.tsx 라우터에 `/earlyteacher2026` 경로 추가
3. 전역 상태로 관리

### Phase 2: UI 분기 처리
1. Hero.tsx의 등록 버튼 핸들러에 분기 추가
2. LayerToggleBar의 등록 버튼 핸들러에 분기 추가
3. ComingSoonModal title props 전달 ("구직등록", "공고등록", "교원연수 강사등록")

### Phase 3: 테스트 및 배포
1. 로컬 테스트: `http://localhost:5173` vs `http://localhost:5173/earlyteacher2026`
2. 일반 접속 시 "준비 중" 모달 확인
3. Early Access 경로 접속 시 실제 등록 가능 확인
4. main 브랜치 머지 후 운영 환경 테스트
5. Cloudflare Pages 리디렉션 설정 확인

---

## 특별 URL 공유 가이드

### 강사 모집용 URL

```
학교일자리.com/earlyteacher2026
xn--9d0bk8ucxkkcw59f.com/earlyteacher2026
```

### 공유 메시지 예시

```
[교원연수 강사 등록 안내]

안녕하세요, 학교일자리입니다.
교원연수 강사 인력풀에 등록을 원하시면
아래 링크로 접속해주세요.

학교일자리.com/earlyteacher2026

* 현직 교사도 등록 가능합니다.
* 정식 오픈 전 사전 등록자 혜택이 있습니다.
```

---

## 보안 고려사항

1. **액세스 경로 노출**: `/earlyteacher2026`은 URL에 노출되므로 민감한 정보 아님
2. **세션 유지**: 로컬스토리지 사용으로 브라우저 재접속 시에도 유지
3. **경로 변경 용이**: 필요시 경로만 변경하면 이전 URL 무효화 가능
4. **기간 제한**: 정식 오픈 시 Early Access 코드 제거 또는 날짜 기반 무효화

---

## 향후 계획

| 시점 | 액션 |
|------|------|
| 즉시 | Early Access 구현 및 main 배포 |
| 1~2주 | 강사/구직자 사전 모집 |
| 2월 중순 | 충분한 데이터 확보 후 일반 공개 |
| 정식 오픈 | Early Access 코드 제거, 전체 공개 |

---

## 확정 사항

### 등록 기능 범위
| 기능 | Early Access | 일반 접속 |
|------|-------------|----------|
| **공고등록** | 개방 (기존대로) | 개방 (기존대로) |
| **구직등록** | 개방 | ComingSoonModal |
| **교원연수 강사등록** | 개방 | ComingSoonModal |

### 로컬스토리지 정책
- **한 번 접속 후 계속 유지**
- `/earlyteacher2026` 경로로 한 번 접속하면 localStorage에 저장
- 이후 일반 경로(`/`)로 접속해도 등록 기능 사용 가능

### Cloudflare Pages 리디렉션
- **별도 설정 불필요**
- Cloudflare Pages는 SPA 모드 기본 지원
- 존재하지 않는 경로 요청 시 자동으로 `index.html` 반환
- `/earlyteacher2026` 직접 접속 → `index.html` 로드 → React Router 클라이언트 처리

---

**작성일**: 2026-01-30
**버전**: 2.0
**프로젝트**: SellmeBuyme (학교일자리)
