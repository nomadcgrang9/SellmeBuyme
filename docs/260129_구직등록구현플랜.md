# 구직등록 기능 구현 플랜

> 작성일: 2026-01-29
> 최종 수정: 2026-01-29 (분석 업데이트)
> 상태: **구현 진행 중**

---

## UI 용어 규칙

| 금지 표현 | 사용 표현 |
|----------|----------|
| 북마크 | **즐겨찾기** |

---

## LayerToggleBar 버튼 UI 규격

**필수**: 모든 버튼은 아이콘 아래에 **한글 레이블** 표시

```
┌─────────────────────────────────────────────────────────────┐
│                    LayerToggleBar                           │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   ┌─────────┐   ┌─────────┐   ┌─────────┐   ┌─────────┐   │
│   │  [icon] │   │  [icon] │   │  [icon] │   │  [icon] │   │
│   │ 구직등록 │   │ 공고등록 │   │ 즐겨찾기 │   │ 프로필  │   │
│   └─────────┘   └─────────┘   └─────────┘   └─────────┘   │
│       ↑             ↑             ↑             ↑         │
│    한글필수      한글필수      한글필수      한글필수      │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

**버튼별 레이블**:
- 구직자 등록: `구직등록`
- 공고 등록: `공고등록`
- 즐겨찾기 목록: `즐겨찾기` (북마크 ❌)
- 프로필/로그인: `프로필` 또는 `로그인`

---

## 0. 현재 구현 상태 분석 (2026-01-29)

### 0.1 구현 완료 항목 ✅

| 항목 | 상태 | 파일 |
|------|------|------|
| LayerToggleBar UI | ✅ 완료 | `src/components/map/LayerToggleBar.tsx` |
| FullScreenLocationPicker | ✅ 완료 | `src/components/map/FullScreenLocationPicker.tsx` |
| TeacherMarkerModal | ✅ 완료 | `src/components/map/TeacherMarkerModal.tsx` |
| DB 저장 함수 | ✅ 완료 | `src/lib/supabase/markers.ts` |
| 마커 지도 렌더링 | ✅ 완료 | `Hero.tsx` (879~950줄) |
| 마커 클릭 팝업 | ✅ 완료 | `MarkerPopup.tsx` |
| **토글 ↔ activeLayers 동기화** | ✅ 완료 | `Hero.tsx` (396~425줄) |
| **프로필 버튼 동작** | ✅ 완료 | `Hero.tsx` (1933~1942줄) → `ProfileModal.tsx` |
| **로그인 후 등록 플로우** | ✅ 완료 | `Hero.tsx` (137~150줄) pendingAction 사용 |
| **즐겨찾기 버튼** | ✅ 완료 | `LayerToggleBar.tsx` (준비 중 토스트) |

### 0.2 미구현 항목 ⚠️

| 항목 | 상태 | 비고 |
|------|------|--------|
| **구직자 마커 형태** | ⚠️ 미구현 | 현재 공고와 같은 핀 형태, 원형+사람 아이콘 필요 |
| **카테고리 분류** | ⚠️ 미구현 | `classifyTeacher()` 함수 없음 |
| **즐겨찾기 기능** | ⚠️ 미구현 | 버튼만 있음, 실제 기능 없음 |

### 0.3 구현 완료된 토글 ↔ activeLayers 동기화

```typescript
// Hero.tsx (396~425줄) - 이미 구현됨
useEffect(() => {
  setActiveLayers(prev => {
    // 둘 다 미선택 = 필터 없음 = 모든 마커 표시
    if (!showJobLayer && !showSeekerLayer) {
      const hasProgram = prev.includes('program');
      return hasProgram ? ['job', 'teacher', 'program'] : ['job', 'teacher'];
    }

    let newLayers = [...prev];

    // 공고 레이어
    if (showJobLayer && !newLayers.includes('job')) {
      newLayers.push('job');
    } else if (!showJobLayer) {
      newLayers = newLayers.filter(l => l !== 'job');
    }

    // 구직자 레이어 (teacher)
    if (showSeekerLayer && !newLayers.includes('teacher')) {
      newLayers.push('teacher');
    } else if (!showSeekerLayer) {
      newLayers = newLayers.filter(l => l !== 'teacher');
    }

    return newLayers;
  });
}, [showJobLayer, showSeekerLayer]);
```

### 0.4 플로우 점검 (사용자 경험) - 모두 정상

```
[로그아웃 상태]
구직등록 클릭 → 로그인 모달 → 로그인 → 자동으로 위치선택 열림 ✅
                                    ↑
                                    pendingAction으로 해결됨

[로그인 상태]
구직등록 클릭 → FullScreenLocationPicker → 위치선택 → TeacherMarkerModal → 등록
    ✅              ✅                        ✅            ✅             ✅

[등록 후]
지도에 마커 표시 → 마커 클릭 → 팝업 표시
    ✅               ✅          ✅

[토글]
토글 버튼 클릭 → 마커 표시/숨김 정상 동작 ✅
```

---

## 1. 핵심 설계 원칙

### 1.1 공고-구직자 마커 통합 체계

**원칙**: 구직자 마커는 공고 마커와 **동일한 분류 체계**를 따른다.

```
┌─────────────────────────────────────────────────────────────────────┐
│                      8가지 카테고리 (통합)                          │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│   유치원    초등담임   교과과목    비교과     특수                  │
│   #8D6E63   #4CAF50   #2196F3    #009688   #FF9800                 │
│                                                                     │
│   방과후/돌봄   행정·교육지원    기타                               │
│   #7C4DFF      #607D8B         #9E9E9E                             │
│                                                                     │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│   📍 공고 마커 (핀 형태)     👤 구직자 마커 (원형+사람)             │
│                                                                     │
│   같은 색상 체계, 다른 형태로 구분                                  │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 1.2 형태로 구분, 색상으로 분류

| 구분 | 공고 마커 | 구직자 마커 |
|------|----------|------------|
| **형태** | 물방울 핀 📍 | 원형 + 사람 실루엣 👤 |
| **색상** | 카테고리별 8색 | 카테고리별 8색 (동일) |
| **내부** | D-day 또는 학교급 첫글자 | 사람 아이콘 |
| **테두리** | 진한 색 stroke | 흰색 stroke (구분) |

---

## 2. 즉시 구현 필요 항목 (우선순위)

### 2.1 [P0] 토글 ↔ activeLayers 동기화

```typescript
// Hero.tsx에 추가
useEffect(() => {
  setActiveLayers(prev => {
    let newLayers = [...prev];

    // 공고 레이어
    if (showJobLayer && !newLayers.includes('job')) {
      newLayers.push('job');
    } else if (!showJobLayer) {
      newLayers = newLayers.filter(l => l !== 'job');
    }

    // 구직자 레이어
    if (showSeekerLayer && !newLayers.includes('teacher')) {
      newLayers.push('teacher');
    } else if (!showSeekerLayer) {
      newLayers = newLayers.filter(l => l !== 'teacher');
    }

    return newLayers;
  });
}, [showJobLayer, showSeekerLayer]);
```

### 2.2 [P0] 프로필 버튼 동작 연결

**현재**: 프로필 버튼 클릭 → `onLoginClick()` 호출 → 로그인 모달 열림 (잘못됨)

**수정 필요**:
- 로그아웃 상태: "로그인" 클릭 → 로그인 모달
- 로그인 상태: 프로필 아바타 클릭 → **프로필 드롭다운 메뉴**

**옵션**:
1. 기존 `ProfileButton` 컴포넌트의 드롭다운 재사용
2. 새로운 간소화된 드롭다운 구현
3. 별도 페이지로 이동

### 2.3 [P1] 로그인 후 등록 플로우 이어가기

```typescript
// Hero.tsx - 로그인 성공 후 콜백
// 구직등록 버튼 클릭 시 로그인 필요했다면, 로그인 완료 후 자동으로 위치선택 열기

const [pendingAction, setPendingAction] = useState<'register' | null>(null);

// 구직등록 클릭 시
onRegisterClick={() => {
  if (!user) {
    setPendingAction('register');  // 대기 액션 저장
    setAuthModalInitialTab('login');
    setIsAuthModalOpen(true);
    return;
  }
  setLocationPickerType('teacher');
  setIsLocationPickerOpen(true);
}}

// 로그인 모달 닫힐 때
<AuthModal
  onClose={() => {
    setIsAuthModalOpen(false);
    // 로그인 성공 + 대기 액션 있으면 이어서 실행
    if (user && pendingAction === 'register') {
      setPendingAction(null);
      setLocationPickerType('teacher');
      setIsLocationPickerOpen(true);
    }
  }}
/>
```

---

## 3. 마커 아이콘 구현 방안

### 3.1 옵션 비교

| 방안 | 설명 | 장점 | 단점 |
|------|------|------|------|
| **A. Solar Icons** ⭐ | `UserCircle`, `UserRounded` 등 | 7,401개 아이콘, 모던 디자인 | 신규 패키지 설치 필요 |
| **B. 직접 SVG** | 원형 + 사람 path 직접 제작 | 완전한 커스터마이징 | 디자인 품질 보장 어려움 |
| **C. Lucide 활용** | 기존 Lucide의 `User` 아이콘 | 추가 설치 불필요 | 스타일 제한적 |

### 3.2 추천: Solar Icons 사용

```bash
npm install @solar-icons/react
```

**아이콘 후보**:
- `UserCircle` Bold - 원형 안에 사람
- `UserRounded` Bold - 둥근 사각형 안에 사람 (추천)

---

## 4. 분류 체계 상세 설계

### 4.1 구직자 → 카테고리 매핑 로직

```typescript
function classifyTeacher(teacher: TeacherMarker): PrimaryCategory {
  const schoolLevels = teacher.school_levels || [];
  const subjects = teacher.subjects || [];

  // P1: 특수
  if (schoolLevels.includes('특수')) return '특수';

  // P2: 비교과
  const bigyogwaSubjects = ['보건', '상담', '사서', '영양'];
  if (subjects.some(s => bigyogwaSubjects.includes(s))) return '비교과';

  // P3: 유치원
  if (schoolLevels.includes('유치원')) return '유치원';

  // P4: 초등담임
  if (schoolLevels.includes('초등') &&
      (subjects.length === 0 || subjects.includes('담임'))) {
    return '초등담임';
  }

  // P5: 교과과목
  if ((schoolLevels.includes('중등') || schoolLevels.includes('고등')) &&
      subjects.length > 0) {
    return '교과과목';
  }

  // P6: 방과후/돌봄
  const afterschoolSubjects = ['체육', '음악', '미술', '코딩', '돌봄'];
  if (subjects.some(s => afterschoolSubjects.some(as => s.includes(as)))) {
    return '방과후/돌봄';
  }

  // P7: 행정·교육지원
  const adminSubjects = ['행정', '실무', '튜터'];
  if (subjects.some(s => adminSubjects.some(as => s.includes(as)))) {
    return '행정·교육지원';
  }

  return '기타';
}
```

---

## 5. 구현 체크리스트

### Phase 0: 즉시 수정 (사용자 경험 막힘 해결) ✅ 완료
- [x] `showJobLayer/showSeekerLayer` ↔ `activeLayers` 동기화 (Hero.tsx 396~425줄)
- [x] 프로필 버튼 클릭 동작 연결 → ProfileModal (Hero.tsx 1933~1942줄)
- [x] 로그인 후 등록 플로우 이어가기 - pendingAction (Hero.tsx 137~150줄)
- [x] 즐겨찾기 버튼 추가 (LayerToggleBar.tsx)

### Phase 1: 기반 작업
- [ ] Solar Icons 설치 (`@solar-icons/react`)
- [ ] `classifyTeacher()` 함수 구현
- [ ] `generateTeacherMarkerSVG()` 함수 구현
- [ ] 원형+사람 마커 SVG 디자인 확정

### Phase 2: UI 연결
- [ ] TeacherMarkerModal에 "희망 분야" 선택 UI 추가 (선택)
- [ ] 구직자 마커 지도 표시 연동 (아이콘 변경)

### Phase 3: 필터/검색 연동
- [ ] CascadingFilterBar에서 구직자 마커 필터링
- [ ] 검색창에서 구직자 마커 검색

### Phase 4: 고도화
- [ ] MarkerPopup 구직자용 UI 개선
- [ ] 연락처 보기 로그인 필수 처리
- [ ] 쪽지/댓글 기능 연동

---

## 6. 결정 필요 사항

### 체크리스트

- [x] **프로필 버튼 동작**: ProfileModal 사용 (로그아웃, 마커 관리 등)
- [ ] **마커 아이콘**: Solar Icons / Lucide / 직접 SVG
- [ ] **카테고리 저장**: DB 필드 추가 (`primary_category`) / 클라이언트 실시간 계산
- [ ] **복수 카테고리**: 구직자가 여러 분야 희망 가능 여부 (주 카테고리 1개 제한 추천)

---

## 7. 참고: 색상 팔레트

```typescript
const PRIMARY_COLORS = {
  '유치원':       { base: '#8D6E63' },
  '초등담임':     { base: '#4CAF50' },
  '교과과목':     { base: '#2196F3' },
  '비교과':       { base: '#009688' },
  '특수':         { base: '#FF9800' },
  '방과후/돌봄':  { base: '#7C4DFF' },
  '행정·교육지원': { base: '#607D8B' },
  '기타':         { base: '#9E9E9E' },
};
```
