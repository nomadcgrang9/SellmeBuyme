# ë“±ë¡ 3ê¸°ëŠ¥ ê°œì„  í”Œëœ

**ì‘ì„±ì¼**: 2026-01-30
**ë²„ì „**: v1.1
**ìƒíƒœ**: RLS/ìŠ¤í† ë¦¬ì§€ í•´ê²° ì™„ë£Œ, UI ê°œì„  ëŒ€ê¸°
**ìµœì¢… ìˆ˜ì •**: 2026-01-30 (ë§ˆì´ê·¸ë ˆì´ì…˜ ì ìš©)

---

## 1. ì‚¬ìš©ì ë‹µë‹µí•¨ í¬ì¸íŠ¸ ìš”ì•½

### í•µì‹¬ UX ë¬¸ì œ
> "ë“±ë¡í–ˆëŠ”ë° ì•ˆ ë³´ì´ê³ , ì‚­ì œí–ˆëŠ”ë° ê·¸ëŒ€ë¡œ ìˆë‹¤"

| ë¬¸ì œ | ì‚¬ìš©ì ê¸°ëŒ€ | í˜„ì¬ ìƒí™© | ë‹µë‹µí•¨ ë ˆë²¨ |
|------|------------|----------|------------|
| **ì‚­ì œ í›„ ì¦‰ì‹œ ë°˜ì˜** | ì‚­ì œí•˜ë©´ ë§ˆì»¤ ì¦‰ì‹œ ì‚¬ë¼ì§ | ìƒˆë¡œê³ ì¹¨ í•„ìš” | ğŸ”´ ë†’ìŒ |
| **ì´ë¯¸ì§€ ì—…ë¡œë“œ ì‹¤íŒ¨** | ì´ë¯¸ì§€ ë„£ê³  ë“±ë¡ | RLS ì˜¤ë¥˜ë¡œ ë“±ë¡ ì‹¤íŒ¨ | ğŸ”´ ë†’ìŒ |
| **HWP íŒŒì¼ ì—…ë¡œë“œ** | HWP íŒŒì¼ ì²¨ë¶€ ê°€ëŠ¥ | MIME íƒ€ì… ë¯¸ì§€ì› | ğŸ”´ ë†’ìŒ |
| **ë“œë˜ê·¸ì•¤ë“œë¡­ ë¯¸ì§€ì›** | ì´ë¯¸ì§€ ë“œë˜ê·¸í•´ì„œ ì—…ë¡œë“œ | íŒŒì¼ì„ íƒ í´ë¦­ í•„ìš” | ğŸŸ¡ ì¤‘ê°„ |
| **ì—°ìˆ˜ê°•ì‚¬ íŒì—… ì •ë³´ ë¯¸ë°˜ì˜** | ë“±ë¡ ì •ë³´ íŒì—…ì— í‘œì‹œ | ì´ë¯¸ì§€/í›„ê¸° ì„¹ì…˜ ì—†ìŒ | ğŸŸ¡ ì¤‘ê°„ |

---

## 2. ì½˜ì†” ì˜¤ë¥˜ ë¶„ì„

### 2.1 RLS ì •ì±… ì˜¤ë¥˜ (êµ¬ì§ ë§ˆì»¤ ì´ë¯¸ì§€)
```
StorageApiError: new row violates row-level security policy
ìœ„ì¹˜: markers.ts:472 (uploadMarkerImage)
```

**ì›ì¸ ë¶„ì„:**
- `markers` ìŠ¤í† ë¦¬ì§€ ë²„í‚·ì˜ RLS ì •ì±…ì´ INSERTë¥¼ í—ˆìš©í•˜ì§€ ì•ŠìŒ
- ë˜ëŠ” ì •ì±… ì¡°ê±´ì´ í˜„ì¬ ì‚¬ìš©ìì™€ ë§ì§€ ì•ŠìŒ

**ì˜í–¥:**
- êµ¬ì§ë“±ë¡ ì‹œ ì´ë¯¸ì§€ ì²¨ë¶€í•˜ë©´ ì „ì²´ ë“±ë¡ ì‹¤íŒ¨
- ì´ë¯¸ì§€ ì—†ì´ ë“±ë¡í•˜ë©´ ì •ìƒ ì‘ë™

**ìˆ˜ì • í•„ìš” ìœ„ì¹˜:**
- Supabase Dashboard â†’ Storage â†’ `markers` ë²„í‚· â†’ RLS ì •ì±…
- ë˜ëŠ” `supabase/migrations/` SQL íŒŒì¼ ì¶”ê°€

### 2.2 HWP MIME íƒ€ì… ë¯¸ì§€ì› (ê³µê³  ì²¨ë¶€íŒŒì¼)
```
StorageApiError: mime type application/haansofthwp is not supported
ìœ„ì¹˜: jobPostings.ts:94 (uploadJobAttachment)
```

**ì›ì¸ ë¶„ì„:**
- Supabase Storage ë²„í‚·ì´ `application/haansofthwp` MIME íƒ€ì…ì„ í—ˆìš©í•˜ì§€ ì•ŠìŒ
- íŒŒì¼ í™•ì¥ì ê²€ì‚¬(`.hwp`)ëŠ” í†µê³¼í•˜ì§€ë§Œ ì‹¤ì œ ì—…ë¡œë“œ ì‹œ MIME íƒ€ì… ì²´í¬ì—ì„œ ì‹¤íŒ¨

**ì˜í–¥:**
- ê³µê³  ë“±ë¡ ì‹œ HWP íŒŒì¼ ì²¨ë¶€í•˜ë©´ ì „ì²´ ë“±ë¡ ì‹¤íŒ¨
- PDF ë“± ë‹¤ë¥¸ í˜•ì‹ì€ ì •ìƒ ì‘ë™

**ìˆ˜ì • í•„ìš” ìœ„ì¹˜:**
- Supabase Dashboard â†’ Storage â†’ ë²„í‚· ì„¤ì • â†’ Allowed MIME types
- `application/haansofthwp`, `application/x-hwp` ì¶”ê°€ í•„ìš”

### 2.3 Kakao Maps ê²½ê³  (ê¸°ëŠ¥ ì˜í–¥ ì—†ìŒ)
```
element.setCapture()ëŠ” ë” ì´ìƒ ì‚¬ìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
```
- Kakao Maps SDK ë‚´ë¶€ ê²½ê³ , ê¸°ëŠ¥ì—ëŠ” ì˜í–¥ ì—†ìŒ
- ë³„ë„ ì¡°ì¹˜ ë¶ˆí•„ìš”

---

## 3. íŒ©íŠ¸ì²´í¬ ê²°ê³¼

### 3.1 ì‚­ì œ í›„ ì¦‰ì‹œ ë°˜ì˜ ë¬¸ì œ âœ… í™•ì¸ë¨

**ì½”ë“œ ë¶„ì„:**
```typescript
// Hero.tsx:2181-2185 (ë§ˆì»¤ ì‚­ì œ)
onDelete={() => {
  setSelectedMarker(null);
  loadMarkerData();  // ì „ì²´ ë¦¬ë¡œë“œ â†’ ëŠë¦¼
}}

// Hero.tsx:1302-1309 (ê³µê³  ì‚­ì œ)
const handleJobDelete = useCallback(async (job: JobPostingCard) => {
  await deleteJobPosting(job.id);
  setJobPostings(prev => prev.filter(j => j.id !== job.id)); // stateë§Œ ë³€ê²½
  // ì§€ë„ ë§ˆì»¤ëŠ” ë³„ë„ë¡œ ì œê±° ì•ˆ ë¨!
});
```

**ë¬¸ì œì :**
- ë§ˆì»¤ ì‚­ì œ: `loadMarkerData()` í˜¸ì¶œí•˜ì§€ë§Œ ì¹´ì¹´ì˜¤ë§µ ë§ˆì»¤ ê°ì²´ëŠ” ë³„ë„ ê´€ë¦¬
- ê³µê³  ì‚­ì œ: stateì—ì„œëŠ” ì œê±°í•˜ì§€ë§Œ ì§€ë„ ë§ˆì»¤ëŠ” ë‹¤ìŒ ë Œë”ë§ ì‚¬ì´í´ê¹Œì§€ ìœ ì§€

**í•„ìš” ìˆ˜ì •:**
- ì‚­ì œ í›„ ë‚™ê´€ì  ì—…ë°ì´íŠ¸ ì ìš© (stateì—ì„œ ì¦‰ì‹œ ì œê±°)
- ì¹´ì¹´ì˜¤ë§µ ë§ˆì»¤ ê°ì²´ë„ ì¦‰ì‹œ ì œê±°

### 3.2 ë“œë˜ê·¸ì•¤ë“œë¡­ ë¯¸ì§€ì› âœ… í™•ì¸ë¨

**ì½”ë“œ ë¶„ì„:**
- `TeacherMarkerModal.tsx`: ë“œë˜ê·¸ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì—†ìŒ
- `InstructorMarkerModal.tsx`: ë“œë˜ê·¸ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì—†ìŒ
- `JobPostingModal.tsx`: `FileDropzone` ì»´í¬ë„ŒíŠ¸ ì‚¬ìš© (ë“œë˜ê·¸ ì§€ì› âœ…)

**í•„ìš” ìˆ˜ì •:**
- TeacherMarkerModal, InstructorMarkerModalì— ë“œë˜ê·¸ì•¤ë“œë¡­ ì§€ì› ì¶”ê°€
- ë˜ëŠ” ê³µí†µ ì´ë¯¸ì§€ ì—…ë¡œë“œ ì»´í¬ë„ŒíŠ¸ ìƒì„±

### 3.3 ì—°ìˆ˜ê°•ì‚¬ íŒì—… ì •ë³´ ë¯¸ë°˜ì˜ âœ… í™•ì¸ë¨

**ì½”ë“œ ë¶„ì„ (MarkerPopup.tsx):**
```typescript
// í”„ë¡œí•„ ì´ë¯¸ì§€ í‘œì‹œ ì½”ë“œ ì—†ìŒ!
// profile_image_url í•„ë“œ ì°¸ì¡° ì—†ìŒ

// í›„ê¸° ì„¹ì…˜ - instructor íƒ€ì… ëª…ì‹œì  ì œì™¸
{type !== 'instructor' && (
  // í›„ê¸° UI...
)}
```

**í•„ìš” ìˆ˜ì •:**
- MarkerPopupì— í”„ë¡œí•„ ì´ë¯¸ì§€ í‘œì‹œ ì¶”ê°€
- instructor íƒ€ì…ë„ í›„ê¸° ì„¹ì…˜ í‘œì‹œ (ë˜ëŠ” ë³„ë„ UI)

### 3.4 ì´ë¯¸ì§€ ì—…ë¡œë“œ ì‹œ ë“±ë¡ ì‹¤íŒ¨ âœ… í™•ì¸ë¨

**ì½”ë“œ ë¶„ì„ (markers.ts:459-480):**
```typescript
export async function uploadMarkerImage(file, markerType, markerId) {
  const { error } = await supabase.storage
    .from('markers')  // ì´ ë²„í‚·ì˜ RLS ì •ì±… ë¬¸ì œ
    .upload(fileName, file);

  if (uploadError) {
    throw uploadError;  // ì—ëŸ¬ ë°œìƒ ì‹œ ì „ì²´ ë“±ë¡ ì‹¤íŒ¨
  }
}
```

**í•„ìš” ìˆ˜ì •:**
- `markers` ë²„í‚· RLS ì •ì±… ìˆ˜ì •
- ë˜ëŠ” `profiles` ë²„í‚· ì‚¬ìš©ìœ¼ë¡œ ë³€ê²½ (InstructorMarkerì™€ ë™ì¼í•˜ê²Œ)

---

## 4. í•´ê²° ë°©ì•ˆ

### 4.1 ìš°ì„ ìˆœìœ„ HIGH (ì¦‰ì‹œ í•´ê²°)

#### A. Storage RLS ì •ì±… ìˆ˜ì •
```sql
-- markers ë²„í‚· INSERT ì •ì±… ì¶”ê°€
CREATE POLICY "Users can upload marker images"
ON storage.objects FOR INSERT
WITH CHECK (
  bucket_id = 'markers' AND
  auth.uid() IS NOT NULL
);
```

#### B. HWP MIME íƒ€ì… í—ˆìš©
- Supabase Dashboardì—ì„œ ë²„í‚· ì„¤ì • ë³€ê²½
- í—ˆìš© MIME íƒ€ì…: `application/haansofthwp`, `application/x-hwp`, `application/octet-stream`

#### C. ì‚­ì œ í›„ ë‚™ê´€ì  ì—…ë°ì´íŠ¸
```typescript
// Hero.tsx ìˆ˜ì •
onDelete={(deletedMarker) => {
  // 1. stateì—ì„œ ì¦‰ì‹œ ì œê±°
  setTeacherMarkers(prev => prev.filter(m => m.id !== deletedMarker.id));
  setInstructorMarkers(prev => prev.filter(m => m.id !== deletedMarker.id));

  // 2. íŒì—… ë‹«ê¸°
  setSelectedMarker(null);

  // DB ì‚­ì œëŠ” ì´ë¯¸ ì™„ë£Œëœ ìƒíƒœ
}}
```

### 4.2 ìš°ì„ ìˆœìœ„ MEDIUM

#### D. ë“œë˜ê·¸ì•¤ë“œë¡­ ì»´í¬ë„ŒíŠ¸ ì¶”ê°€
- `ImageDropzone.tsx` ê³µí†µ ì»´í¬ë„ŒíŠ¸ ìƒì„±
- TeacherMarkerModal, InstructorMarkerModalì— ì ìš©

#### E. MarkerPopup í”„ë¡œí•„ ì´ë¯¸ì§€ í‘œì‹œ
```typescript
// MarkerPopup.tsx ìˆ˜ì •
{marker.profile_image_url && (
  <img
    src={marker.profile_image_url}
    alt="í”„ë¡œí•„"
    className="w-16 h-16 rounded-full object-cover"
  />
)}
```

### 4.3 ìš°ì„ ìˆœìœ„ LOW

#### F. ì—°ìˆ˜ê°•ì‚¬ í›„ê¸° ì‹œìŠ¤í…œ
- instructor_comments í…Œì´ë¸” ìƒì„±
- MarkerPopupì—ì„œ instructor íƒ€ì…ë„ í›„ê¸° í‘œì‹œ

---

## 5. êµ¬í˜„ ìˆœì„œ

```
1ë‹¨ê³„: RLS ì •ì±… ìˆ˜ì • (ë§ˆì´ê·¸ë ˆì´ì…˜ SQL)
   â†“
2ë‹¨ê³„: HWP MIME íƒ€ì… í—ˆìš© (Supabase ëŒ€ì‹œë³´ë“œ)
   â†“
3ë‹¨ê³„: ì‚­ì œ ë‚™ê´€ì  ì—…ë°ì´íŠ¸ (Hero.tsx)
   â†“
4ë‹¨ê³„: ë“œë˜ê·¸ì•¤ë“œë¡­ ì»´í¬ë„ŒíŠ¸ (ImageDropzone.tsx)
   â†“
5ë‹¨ê³„: MarkerPopup í”„ë¡œí•„ ì´ë¯¸ì§€ (MarkerPopup.tsx)
   â†“
6ë‹¨ê³„: ì—°ìˆ˜ê°•ì‚¬ í›„ê¸° ì‹œìŠ¤í…œ (ì„ íƒì )
```

---

## 6. ì˜í–¥ ë¶„ì„

| ìˆ˜ì • í•­ëª© | ì˜í–¥ íŒŒì¼ | í…ŒìŠ¤íŠ¸ í•„ìš” ì˜ì—­ |
|----------|----------|-----------------|
| RLS ì •ì±… | migrations/*.sql | êµ¬ì§ë“±ë¡ + ì´ë¯¸ì§€ |
| MIME íƒ€ì… | Supabase ëŒ€ì‹œë³´ë“œ | ê³µê³ ë“±ë¡ + HWP ì²¨ë¶€ |
| ì‚­ì œ ì—…ë°ì´íŠ¸ | Hero.tsx, MarkerPopup.tsx | ë§ˆì»¤ ì‚­ì œ í”Œë¡œìš° |
| ë“œë˜ê·¸ì•¤ë“œë¡­ | ì‹ ê·œ ì»´í¬ë„ŒíŠ¸, Modalë“¤ | ì´ë¯¸ì§€ ì—…ë¡œë“œ UX |
| í”„ë¡œí•„ ì´ë¯¸ì§€ | MarkerPopup.tsx | ë§ˆì»¤ íŒì—… í‘œì‹œ |

---

## 7. ì²´í¬ë¦¬ìŠ¤íŠ¸

- [x] markers ë²„í‚· RLS ì •ì±… ìˆ˜ì • (2026-01-30 ì™„ë£Œ)
- [x] job_attachments ë²„í‚· HWP MIME í—ˆìš© (2026-01-30 ì™„ë£Œ)
- [x] ì‚­ì œ í›„ ë‚™ê´€ì  ì—…ë°ì´íŠ¸ êµ¬í˜„ (ì´ì „ ì„¸ì…˜ì—ì„œ ì™„ë£Œ)
- [ ] ImageDropzone ê³µí†µ ì»´í¬ë„ŒíŠ¸ ìƒì„±
- [ ] TeacherMarkerModal ë“œë˜ê·¸ì•¤ë“œë¡­ ì ìš©
- [ ] InstructorMarkerModal ë“œë˜ê·¸ì•¤ë“œë¡­ ì ìš©
- [x] MarkerPopup í”„ë¡œí•„ ì´ë¯¸ì§€ í‘œì‹œ ì¶”ê°€ (2026-01-30 ì™„ë£Œ, ì—†ìœ¼ë©´ ê¸°ë³¸ ì•„ì´ì½˜)
- [x] MarkerPopup ì¢‹ì•„ìš” ë²„íŠ¼ ì¶”ê°€ (2026-01-30 ì™„ë£Œ)
- [x] instructor íƒ€ì… í›„ê¸° ì‹œìŠ¤í…œ ì¶”ê°€ (2026-01-30 ì™„ë£Œ)
- [x] marker_likes, instructor_comments í…Œì´ë¸” ìƒì„± (2026-01-30 ì™„ë£Œ)
- [ ] ì „ì²´ ë“±ë¡/ì‚­ì œ í”Œë¡œìš° E2E í…ŒìŠ¤íŠ¸

---

## 8. UI ê°œì„  ASCII ëª©ì—…

### 8.1 MarkerPopup ê°œì„ ì•ˆ (Anti-Vibe Design ì ìš©)

> **ë””ìì¸ ì›ì¹™ ì²´í¬ë¦¬ìŠ¤íŠ¸**
> - ì´ëª¨ì§€ ì‚¬ìš© ì•ˆí•¨
> - ê¸€ì ë’¤ ë°°ê²½ìƒ‰ ì‚¬ìš© ì•ˆí•¨ (í˜•ê´‘íœ ê¸ˆì§€)
> - í”„ë¡œì íŠ¸ ì»¬ëŸ¬ íŒ”ë ˆíŠ¸ ì‚¬ìš©: ë©”ì¸ #3B82F6, ê°•ì‚¬ #EC4899
> - ë°”ì´ë¸Œì½”ë”© ëƒ„ìƒˆ ê¸ˆì§€ (ê³¼í•œ ê·¸ë¼ë””ì–¸íŠ¸, ì›ìƒ‰ ì¡°í•© ê¸ˆì§€)

#### A. êµ¬ì§ì ë§ˆì»¤ íŒì—… (ì¢‹ì•„ìš” ë²„íŠ¼ + í›„ê¸°)
```
+------------------------------------------+
| [*] ê¹€ì„ ìƒë‹˜                    [x] |
+------------------------------------------+
|  +------+                                |
|  | IMG  |  ê³¼ëª©: ìˆ˜í•™, ì˜ì–´              |
|  | 48px |  í•™êµê¸‰: ì¤‘ë“±, ê³ ë“±            |
|  +------+  ê²½ë ¥: 3ë…„ì°¨                   |
|                                          |
|  "ì—´ì •ì ìœ¼ë¡œ ê°€ë¥´ì¹˜ëŠ” ì„ ìƒë‹˜ì…ë‹ˆë‹¤"      |
|                                          |
|  [mail] teacher@email.com                |
+------------------------------------------+
| [Heart] 12  |  í›„ê¸° (3)            [v]   |
+------------------------------------------+
|  +----------------------------------------+
|  | ìµëª… (2026-01-28)                      |
|  | "ìˆ˜ì—… ì˜ í•˜ì…¨ì–´ìš”"                     |
|  +----------------------------------------+
|  | í•™êµê´€ê³„ì (2026-01-25)                |
|  | "ê¼¼ê¼¼í•œ ìˆ˜ì—… ì¤€ë¹„"                     |
|  +----------------------------------------+
|  +--[í›„ê¸° ë‚¨ê¸°ê¸°]--+                      |
+------------------------------------------+
```

#### B. êµì›ì—°ìˆ˜ ê°•ì‚¬ ë§ˆì»¤ íŒì—… (ì¢‹ì•„ìš” + í”„ë¡œí•„ì´ë¯¸ì§€ + í›„ê¸°)
```
+------------------------------------------+
| [*] í™ê°•ì‚¬ë‹˜                   [-][x]    |
+------------------------------------------+
|  +------+                                |
|  |PHOTO |  ì „ë¬¸ë¶„ì•¼: AIêµìœ¡, ì½”ë”©êµìœ¡    |
|  | 48px |  ì—°ìˆ˜ëŒ€ìƒ: ì´ˆë“±, ì¤‘ë“±          |
|  +------+  í™œë™ì§€ì—­: ì„œìš¸, ê²½ê¸°          |
|            ê²½ë ¥: 5ë…„ì°¨                   |
|                                          |
|  "êµì› ëŒ€ìƒ AI í™œìš© ì—°ìˆ˜ ì „ë¬¸"           |
|                                          |
|  [mail] instructor@email.com             |
+------------------------------------------+
| [Heart] 8   |  í›„ê¸° (2)            [v]   |
+------------------------------------------+
|  +----------------------------------------+
|  | ì—°ìˆ˜ì°¸ì—¬êµì‚¬ (2026-01-27)              |
|  | "ì‹¤ìŠµ ìœ„ì£¼ë¡œ ì¢‹ì•˜ìŠµë‹ˆë‹¤"               |
|  +----------------------------------------+
|  +--[í›„ê¸° ë‚¨ê¸°ê¸°]--+                      |
+------------------------------------------+
```

#### C. ì¢‹ì•„ìš” ë²„íŠ¼ ìƒì„¸ (ì•„ì´ì½˜ ê¸°ë°˜, ì´ëª¨ì§€ ê¸ˆì§€)
```
ë¹„ì„ íƒ ìƒíƒœ:                   ì„ íƒ ìƒíƒœ:
+----------+                   +----------+
| [O] 12   |                   | [*] 13   |
+----------+                   +----------+
  ^ë¹ˆ í•˜íŠ¸                       ^ì±„ì›Œì§„ í•˜íŠ¸
  gray-400                       red-500 (#EF4444)
```

**ì•„ì´ì½˜ ì°¸ì¡° (lucide-react)**
- ë¹„ì„ íƒ: `<Heart size={16} className="text-gray-400" />`
- ì„ íƒ: `<Heart size={16} fill="#EF4444" className="text-red-500" />`

### 8.2 í›„ê¸° ì‹œìŠ¤í…œ DB ìŠ¤í‚¤ë§ˆ

#### instructor_comments í…Œì´ë¸” (ì‹ ê·œ ìƒì„± í•„ìš”)
```sql
CREATE TABLE instructor_comments (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  instructor_id UUID NOT NULL REFERENCES instructor_markers(id) ON DELETE CASCADE,
  author_name VARCHAR(50) DEFAULT 'ìµëª…',
  content TEXT NOT NULL,
  created_at TIMESTAMPTZ DEFAULT now()
);

-- RLS ì •ì±…
ALTER TABLE instructor_comments ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Anyone can read comments"
ON instructor_comments FOR SELECT USING (true);

CREATE POLICY "Anyone can create comments"
ON instructor_comments FOR INSERT WITH CHECK (true);
```

#### marker_likes í…Œì´ë¸” (ì‹ ê·œ ìƒì„± í•„ìš”)
```sql
CREATE TABLE marker_likes (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  marker_type VARCHAR(20) NOT NULL, -- 'teacher' | 'instructor'
  marker_id UUID NOT NULL,
  user_fingerprint VARCHAR(64) NOT NULL, -- ë¹„ë¡œê·¸ì¸ ì‚¬ìš©ì ì§€ë¬¸
  created_at TIMESTAMPTZ DEFAULT now(),

  UNIQUE(marker_type, marker_id, user_fingerprint)
);

-- RLS ì •ì±…
ALTER TABLE marker_likes ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Anyone can read likes"
ON marker_likes FOR SELECT USING (true);

CREATE POLICY "Anyone can like"
ON marker_likes FOR INSERT WITH CHECK (true);

CREATE POLICY "Anyone can unlike"
ON marker_likes FOR DELETE USING (true);
```

### 8.3 ì»´í¬ë„ŒíŠ¸ ë ˆì´ì•„ì›ƒ (CSS í´ë˜ìŠ¤)

#### í—¤ë” + í”„ë¡œí•„ ì´ë¯¸ì§€ ì˜ì—­
```tsx
// í”„ë¡œí•„ ì´ë¯¸ì§€ + ê¸°ë³¸ ì •ë³´ ì„¹ì…˜
<div className="flex items-start gap-3 mb-3">
  {marker.profile_image_url && (
    <img
      src={marker.profile_image_url}
      alt="í”„ë¡œí•„"
      className="w-12 h-12 rounded-full object-cover border border-gray-200"
    />
  )}
  <div className="flex-1 min-w-0">
    {/* íƒœê·¸ë“¤ */}
  </div>
</div>
```

#### ì¢‹ì•„ìš” + í›„ê¸° í† ê¸€ ë°”
```tsx
// ì¢‹ì•„ìš” ë²„íŠ¼ + í›„ê¸° í† ê¸€ ì˜ì—­
<div className="flex items-center justify-between px-4 py-2 border-t border-gray-100">
  {/* ì¢‹ì•„ìš” */}
  <button
    onClick={handleLike}
    className="flex items-center gap-1.5 text-sm"
  >
    <Heart
      size={16}
      fill={isLiked ? '#EF4444' : 'none'}
      className={isLiked ? 'text-red-500' : 'text-gray-400'}
    />
    <span className={isLiked ? 'text-red-500 font-medium' : 'text-gray-500'}>
      {likeCount}
    </span>
  </button>

  {/* í›„ê¸° í† ê¸€ */}
  <button
    onClick={toggleComments}
    className="flex items-center gap-1.5 text-sm text-gray-600"
  >
    <span>í›„ê¸° {comments.length > 0 ? `(${comments.length})` : ''}</span>
    <ChevronDown size={16} className={showComments ? 'rotate-180' : ''} />
  </button>
</div>
```

### 8.4 êµ¬í˜„ ìš°ì„ ìˆœìœ„

1. **í”„ë¡œí•„ ì´ë¯¸ì§€ í‘œì‹œ** (ê°„ë‹¨)
   - MarkerPopup.tsxì— profile_image_url ì°¸ì¡° ì¶”ê°€
   - ì¡°ê±´ë¶€ ë Œë”ë§

2. **ì¢‹ì•„ìš” ë²„íŠ¼** (ì¤‘ê°„)
   - marker_likes í…Œì´ë¸” ìƒì„±
   - localStorage ê¸°ë°˜ user_fingerprint ìƒì„±
   - í† ê¸€ ë¡œì§ êµ¬í˜„

3. **instructor í›„ê¸° ì‹œìŠ¤í…œ** (ì¤‘ê°„)
   - instructor_comments í…Œì´ë¸” ìƒì„±
   - ê¸°ì¡´ MarkerPopup í›„ê¸° ë¡œì§ í™•ì¥ (type !== 'instructor' ì¡°ê±´ ì œê±°)

---

## 9. ì™„ë£Œëœ ë§ˆì´ê·¸ë ˆì´ì…˜

### 2026-01-30: add_markers_bucket_rls_and_hwp_mime
```sql
-- markers ë²„í‚· RLS ì •ì±… ì¶”ê°€
CREATE POLICY "Authenticated users can upload marker images"
ON storage.objects FOR INSERT TO authenticated
WITH CHECK (bucket_id = 'markers' AND (storage.foldername(name))[1] IN ('teacher', 'instructor'));

CREATE POLICY "Anyone can read marker images"
ON storage.objects FOR SELECT
USING (bucket_id = 'markers');

CREATE POLICY "Users can delete own marker images"
ON storage.objects FOR DELETE TO authenticated
USING (bucket_id = 'markers' AND owner = auth.uid());

-- job-attachments ë²„í‚· HWP MIME íƒ€ì… ì¶”ê°€
UPDATE storage.buckets
SET allowed_mime_types = ARRAY[
  'application/pdf',
  'application/x-hwp',
  'application/vnd.hancom.hwp',
  'application/haansofthwp',  -- ì¶”ê°€ë¨
  'application/octet-stream', -- ì¶”ê°€ë¨
  'application/msword',
  'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
  'application/vnd.ms-excel',
  'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
  'image/jpeg', 'image/png', 'image/gif'
]
WHERE id = 'job-attachments';
```

### 2026-01-30: add_marker_likes_and_instructor_comments
```sql
-- ë§ˆì»¤ ì¢‹ì•„ìš” í…Œì´ë¸”
CREATE TABLE marker_likes (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  marker_type VARCHAR(20) NOT NULL CHECK (marker_type IN ('teacher', 'instructor')),
  marker_id UUID NOT NULL,
  user_fingerprint VARCHAR(64) NOT NULL,
  created_at TIMESTAMPTZ DEFAULT now(),
  UNIQUE(marker_type, marker_id, user_fingerprint)
);

CREATE INDEX idx_marker_likes_marker ON marker_likes(marker_type, marker_id);

ALTER TABLE marker_likes ENABLE ROW LEVEL SECURITY;
CREATE POLICY "marker_likes_select" ON marker_likes FOR SELECT USING (true);
CREATE POLICY "marker_likes_insert" ON marker_likes FOR INSERT WITH CHECK (true);
CREATE POLICY "marker_likes_delete" ON marker_likes FOR DELETE USING (true);

-- êµì›ì—°ìˆ˜ ê°•ì‚¬ í›„ê¸° í…Œì´ë¸”
CREATE TABLE instructor_comments (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  instructor_id UUID NOT NULL REFERENCES instructor_markers(id) ON DELETE CASCADE,
  author_name VARCHAR(50) DEFAULT 'ìµëª…',
  content TEXT NOT NULL,
  created_at TIMESTAMPTZ DEFAULT now()
);

CREATE INDEX idx_instructor_comments_instructor ON instructor_comments(instructor_id);

ALTER TABLE instructor_comments ENABLE ROW LEVEL SECURITY;
CREATE POLICY "instructor_comments_select" ON instructor_comments FOR SELECT USING (true);
CREATE POLICY "instructor_comments_insert" ON instructor_comments FOR INSERT WITH CHECK (true);
```

---

## 10. ì°¸ê³ 

### ê´€ë ¨ íŒŒì¼
- `src/lib/supabase/markers.ts` - ë§ˆì»¤ CRUD + ì´ë¯¸ì§€ ì—…ë¡œë“œ
- `src/lib/supabase/instructorMarkers.ts` - ê°•ì‚¬ ë§ˆì»¤ CRUD
- `src/lib/supabase/jobPostings.ts` - ê³µê³  CRUD + ì²¨ë¶€íŒŒì¼
- `src/pages/new-landing/components/Hero.tsx` - ë©”ì¸ ì§€ë„ ì»´í¬ë„ŒíŠ¸
- `src/components/map/MarkerPopup.tsx` - ë§ˆì»¤ íŒì—…
- `src/components/map/TeacherMarkerModal.tsx` - êµ¬ì§ë“±ë¡ ëª¨ë‹¬
- `src/components/map/InstructorMarkerModal.tsx` - ê°•ì‚¬ë“±ë¡ ëª¨ë‹¬
- `src/components/job/JobPostingModal.tsx` - ê³µê³ ë“±ë¡ ëª¨ë‹¬

### ê´€ë ¨ Supabase ë¦¬ì†ŒìŠ¤
- Storage ë²„í‚·: `markers`, `profiles`, `job_attachments`
- í…Œì´ë¸”: `teacher_markers`, `instructor_markers`, `job_postings`
