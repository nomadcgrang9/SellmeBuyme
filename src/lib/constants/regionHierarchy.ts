/**
 * 광역시도 → 기초자치단체 계층 매핑
 *
 * 목적: 광역시도 전체 검색 시 해당 광역시도 내 모든 기초자치단체 공고를 검색할 수 있도록 지원
 *
 * 사용 예시:
 * - "경기 전체" 검색 → 경기도 + 의정부 + 남양주 + 수원 + ... 모든 경기도 시/군 검색
 * - "서울 전체" 검색 → 서울 + 강남구 + 서초구 + ... 모든 서울 자치구 검색
 */

/**
 * 광역시도 → 기초자치단체 매핑
 * - 키: 광역시도 이름 (검색 패턴으로 사용)
 * - 값: 해당 광역시도 내 기초자치단체 목록 (DB location 필드에 저장된 다양한 형태 포함)
 */
export const PROVINCE_TO_CITIES: Record<string, string[]> = {
  서울: [
    '강남구',
    '강동구',
    '강북구',
    '강서구',
    '관악구',
    '광진구',
    '구로구',
    '금천구',
    '노원구',
    '도봉구',
    '동대문구',
    '동작구',
    '마포구',
    '서대문구',
    '서초구',
    '성동구',
    '성북구',
    '송파구',
    '양천구',
    '영등포구',
    '용산구',
    '은평구',
    '종로구',
    '중구',
    '중랑구',
  ],

  경기: [
    // 시 단위
    '수원',
    '수원시',
    '성남',
    '성남시',
    '고양',
    '고양시',
    '용인',
    '용인시',
    '부천',
    '부천시',
    '안산',
    '안산시',
    '안양',
    '안양시',
    '남양주',
    '남양주시',
    '화성',
    '화성시',
    '평택',
    '평택시',
    '의정부',
    '의정부시',
    '시흥',
    '시흥시',
    '파주',
    '파주시',
    '김포',
    '김포시',
    '광명',
    '광명시',
    '광주',
    '광주시',
    '군포',
    '군포시',
    '오산',
    '오산시',
    '이천',
    '이천시',
    '안성',
    '안성시',
    '구리',
    '구리시',
    '포천',
    '포천시',
    '의왕',
    '의왕시',
    '하남',
    '하남시',
    '여주',
    '여주시',
    '양주',
    '양주시',
    '동두천',
    '동두천시',
    '과천',
    '과천시',
    // 군 단위
    '가평',
    '가평군',
    '양평',
    '양평군',
    '연천',
    '연천군',
    // 복합 지역 (교육지원청 관할)
    '구리남양주',
  ],

  인천: [
    '중구',
    '동구',
    '미추홀구',
    '연수구',
    '남동구',
    '부평구',
    '계양구',
    '서구',
    '강화군',
    '옹진군',
  ],

  강원: [
    // 시 단위
    '춘천',
    '춘천시',
    '원주',
    '원주시',
    '강릉',
    '강릉시',
    '동해',
    '동해시',
    '태백',
    '태백시',
    '속초',
    '속초시',
    '삼척',
    '삼척시',
    // 군 단위
    '홍천',
    '홍천군',
    '횡성',
    '횡성군',
    '영월',
    '영월군',
    '평창',
    '평창군',
    '정선',
    '정선군',
    '철원',
    '철원군',
    '화천',
    '화천군',
    '양구',
    '양구군',
    '인제',
    '인제군',
    '고성',
    '고성군',
    '양양',
    '양양군',
  ],

  부산: [
    '중구',
    '서구',
    '동구',
    '영도구',
    '부산진구',
    '동래구',
    '남구',
    '북구',
    '해운대구',
    '사하구',
    '금정구',
    '강서구',
    '연제구',
    '수영구',
    '사상구',
    '기장군',
  ],

  대구: [
    '중구',
    '동구',
    '서구',
    '남구',
    '북구',
    '수성구',
    '달서구',
    '달성군',
    '군위군',
  ],

  광주: ['동구', '서구', '남구', '북구', '광산구'],

  대전: ['동구', '중구', '서구', '유성구', '대덕구'],

  울산: ['중구', '남구', '동구', '북구', '울주군'],

  세종: ['세종시', '세종특별자치시'],

  충북: [
    '청주',
    '청주시',
    '충주',
    '충주시',
    '제천',
    '제천시',
    '보은',
    '보은군',
    '옥천',
    '옥천군',
    '영동',
    '영동군',
    '증평',
    '증평군',
    '진천',
    '진천군',
    '괴산',
    '괴산군',
    '음성',
    '음성군',
    '단양',
    '단양군',
  ],

  충남: [
    '천안',
    '천안시',
    '공주',
    '공주시',
    '보령',
    '보령시',
    '아산',
    '아산시',
    '서산',
    '서산시',
    '논산',
    '논산시',
    '계룡',
    '계룡시',
    '당진',
    '당진시',
    '금산',
    '금산군',
    '부여',
    '부여군',
    '서천',
    '서천군',
    '청양',
    '청양군',
    '홍성',
    '홍성군',
    '예산',
    '예산군',
    '태안',
    '태안군',
  ],

  전북: [
    '전주',
    '전주시',
    '군산',
    '군산시',
    '익산',
    '익산시',
    '정읍',
    '정읍시',
    '남원',
    '남원시',
    '김제',
    '김제시',
    '완주',
    '완주군',
    '진안',
    '진안군',
    '무주',
    '무주군',
    '장수',
    '장수군',
    '임실',
    '임실군',
    '순창',
    '순창군',
    '고창',
    '고창군',
    '부안',
    '부안군',
  ],

  전남: [
    '목포',
    '목포시',
    '여수',
    '여수시',
    '순천',
    '순천시',
    '나주',
    '나주시',
    '광양',
    '광양시',
    '담양',
    '담양군',
    '곡성',
    '곡성군',
    '구례',
    '구례군',
    '고흥',
    '고흥군',
    '보성',
    '보성군',
    '화순',
    '화순군',
    '장흥',
    '장흥군',
    '강진',
    '강진군',
    '해남',
    '해남군',
    '영암',
    '영암군',
    '무안',
    '무안군',
    '함평',
    '함평군',
    '영광',
    '영광군',
    '장성',
    '장성군',
    '완도',
    '완도군',
    '진도',
    '진도군',
    '신안',
    '신안군',
  ],

  경북: [
    '포항',
    '포항시',
    '경주',
    '경주시',
    '김천',
    '김천시',
    '안동',
    '안동시',
    '구미',
    '구미시',
    '영주',
    '영주시',
    '영천',
    '영천시',
    '상주',
    '상주시',
    '문경',
    '문경시',
    '경산',
    '경산시',
    '의성',
    '의성군',
    '청송',
    '청송군',
    '영양',
    '영양군',
    '영덕',
    '영덕군',
    '청도',
    '청도군',
    '고령',
    '고령군',
    '성주',
    '성주군',
    '칠곡',
    '칠곡군',
    '예천',
    '예천군',
    '봉화',
    '봉화군',
    '울진',
    '울진군',
    '울릉',
    '울릉군',
  ],

  경남: [
    '창원',
    '창원시',
    '진주',
    '진주시',
    '통영',
    '통영시',
    '사천',
    '사천시',
    '김해',
    '김해시',
    '밀양',
    '밀양시',
    '거제',
    '거제시',
    '양산',
    '양산시',
    '의령',
    '의령군',
    '함안',
    '함안군',
    '창녕',
    '창녕군',
    '고성',
    '고성군',
    '남해',
    '남해군',
    '하동',
    '하동군',
    '산청',
    '산청군',
    '함양',
    '함양군',
    '거창',
    '거창군',
    '합천',
    '합천군',
  ],

  제주: ['제주시', '서귀포', '서귀포시'],
};

/**
 * 광역시도 이름 목록 (검색 옵션용)
 */
export const PROVINCE_NAMES = Object.keys(PROVINCE_TO_CITIES);

/**
 * 광역시도 전체 검색 옵션 (UI 드롭다운용)
 */
export const PROVINCE_FULL_OPTIONS = PROVINCE_NAMES.map(
  (name) => `${name} 전체`
);

/**
 * 역매핑: 기초자치단체 → 광역시도
 * 특정 기초자치단체가 어느 광역시도에 속하는지 찾을 때 사용
 */
export const CITY_TO_PROVINCE: Record<string, string> = {};
for (const [province, cities] of Object.entries(PROVINCE_TO_CITIES)) {
  for (const city of cities) {
    CITY_TO_PROVINCE[city] = province;
  }
}

/**
 * 광역시도명에서 검색 키워드 추출
 * 예: "경기도 전체" → "경기", "서울특별시 전체" → "서울"
 */
export function extractProvinceKey(regionFilter: string): string | null {
  // "전체" 제거
  let cleaned = regionFilter.replace(' 전체', '').replace('전체', '');

  // 광역시도 접미사 제거
  cleaned = cleaned
    .replace('특별시', '')
    .replace('광역시', '')
    .replace('특별자치시', '')
    .replace('특별자치도', '')
    .replace('도', '');

  // PROVINCE_TO_CITIES에 키가 있는지 확인
  if (PROVINCE_TO_CITIES[cleaned]) {
    return cleaned;
  }

  // 원본 값으로도 확인
  if (PROVINCE_TO_CITIES[regionFilter.replace(' 전체', '')]) {
    return regionFilter.replace(' 전체', '');
  }

  return null;
}

/**
 * 광역시도 전체 검색인지 확인
 */
export function isProvinceWideSearch(regionFilter: string): boolean {
  return (
    regionFilter.includes('전체') && extractProvinceKey(regionFilter) !== null
  );
}

/**
 * 광역시도 전체 검색 시 해당 광역시도 내 모든 지역 목록 반환
 * @param regionFilter - 검색 필터 값 (예: "경기 전체", "서울 전체")
 * @returns 광역시도명 + 모든 기초자치단체명 배열
 */
export function expandProvinceToAllCities(regionFilter: string): string[] {
  const provinceKey = extractProvinceKey(regionFilter);

  if (!provinceKey) {
    // 광역시도 전체 검색이 아닌 경우 원본 반환
    return [regionFilter];
  }

  const cities = PROVINCE_TO_CITIES[provinceKey] || [];

  // 광역시도명 자체도 포함 (DB에 "경기", "서울" 등으로 저장된 경우 대응)
  return [provinceKey, ...cities];
}
